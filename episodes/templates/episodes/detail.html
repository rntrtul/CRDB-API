{% extends 'base.html' %}
{%load episodes_extra%}
{% block content %} 
    <h1>Title: {{episode.title }}</h1>
    <h2>Number: {{episode.num}}</h2>
    <p>Campaign: {{episode.campaign.num}}/
        <a href="{%url 'campaigns:detail' episode.campaign_id%}">{{episode.campaign.name}}</a>
    </p>
    <p>Description: {{episode.description}}</p>
    <p>Length: {%format_time episode.length%}</p>
    <p>Gameplay Time: {%format_time episode.gameplay_length%}</p>
    <p>First Half length: {%format_time episode.first_half_length%}</p>
    <p>Second Half length: {%format_time episode.second_half_length%}</p>
    <p>Break length:
        <abbr title= "{%format_duration episode.first_half_end episode.second_half_start%}" >{%format_time episode.break_length%}</abbr>
    </p>

    {%if apperances%}
        <h3>Characters: </h3>

        <ul>
        {%for app in apperances%}
            <li><a href="{%url 'characters:detail' app.character_id%}">{{app.character.full_name}}</a></li>
        {%endfor%}
        </ul>
		{%endif%}
		
    {%if level_progs%}
        <h3>Level Progressions: </h3>
        <ul>
        {%for lp in level_progs%}
					<li>{{lp.sheet.character.full_name}} leveled up to level {{lp.level}}</li>
        {%endfor%}
        </ul>
        
    {%endif%}
    <h3>All Rolls  ({{rolls.count}}):</h3>
    
    <table>
        <tr>
            <th>Time Stamp</th>
            <th>Character</th>
            <th>Roll Type</th>
            <th>Final Value</th>
            <th>Natural Value</th>
            <th>Notes</th>
            <th>Damage</th>
            <th>Kills</th>
        </tr>
    {% for roll in rolls %}
        <tr>
            <td><a href="{%url 'rolls:detail' roll.id%}">{{ roll.time_formated}}</a></td>
            <td>{{roll.character.name}}</td>
            <td>{{roll.roll_type.name}}</td>
            <td>{{roll.final_value}}</td>
            <td>{{roll.natural_value}}</td>
            <td>{{roll.notes}}</td>
            <td>{{roll.damage}}</td>
            <td>{{roll.kill_count}}</td>
        </tr>
    {% endfor %}
    </table>
{%endblock%}
